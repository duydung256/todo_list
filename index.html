<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> タスクリスト | Todo App</title>
    <meta name="description" content="Beautiful Japanese-style todo list application">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ef4444">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body class="min-h-screen">
    <div class="sakura-bg"></div>

    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Header -->
        <header class="flex items-center justify-between mb-8">
            <div class="flex items-center">
                <div class="bg-red-500 text-white p-2 rounded-md mr-3">
                    <!-- Thay thế icon font bằng SVG -->
                    <img src="icons/icon.svg" alt="Logo" class="w-6 h-6" />
                </div>
                <h1 class="text-2xl font-bold text-gray-800">タスクリスト</h1>
            </div>
            <div class="text-xl text-gray-600 flex items-center gap-4">
                <button id="dark-mode-toggle" class="p-2 rounded-md hover:bg-gray-100 transition">
                    <i class="fas fa-moon text-gray-600"></i>
                </button>
                <span id="current-date" class="font-medium"></span>
            </div>
        </header>

        <!-- Main Content -->
        <div class="flex flex-col lg:flex-row gap-6">
            <!-- Todo List Section -->
            <div class="bg-white rounded-lg shadow-md p-6 border border-gray-200 flex-1">
                <!-- Add Task Form -->
                <form id="task-form" class="mb-6">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="relative flex-grow">
                            <input type="text" id="task-input" placeholder="新しいタスクを追加..."
                                class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-300"
                                autocomplete="off">
                            <span class="absolute right-3 top-3 text-gray-400">
                                <i class="fas fa-pen"></i>
                            </span>
                        </div>
                        <button type="submit"
                            class="bg-red-500 hover:bg-red-600 text-white px-4 py-3 rounded-md transition flex items-center">
                            <span>追加</span>
                            <i class="fas fa-plus ml-2"></i>
                        </button>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="relative flex-grow">
                            <input type="date" id="due-date-input"
                                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-300 text-sm">
                            <label class="absolute -top-2 left-2 bg-white px-1 text-xs text-gray-500">期限日
                                (オプション)</label>
                        </div>
                        <select id="priority-input"
                            class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-300 text-sm">
                            <option value="normal">通常</option>
                            <option value="high">高</option>
                            <option value="low">低</option>
                        </select>
                        <select id="category-input"
                            class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-300 text-sm">
                            <option value="general">一般</option>
                            <option value="work">仕事</option>
                            <option value="personal">個人</option>
                            <option value="shopping">買い物</option>
                            <option value="health">健康</option>
                        </select>
                    </div>
                </form>

                <!-- Search and Sort -->
                <div class="mb-4 flex gap-3">
                    <div class="relative flex-grow">
                        <input type="text" id="search-input" placeholder="タスクを検索..."
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-300 text-sm">
                        <i class="fas fa-search absolute right-3 top-2.5 text-gray-400"></i>
                    </div>
                    <select id="sort-select"
                        class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none text-sm">
                        <option value="created">作成日順</option>
                        <option value="dueDate">期限日順</option>
                        <option value="priority">優先度順</option>
                        <option value="alphabetical">アルファベット順</option>
                    </select>
                </div>

                <!-- Task Filters -->
                <div class="flex mb-4 border-b border-gray-200">
                    <button id="all-tasks"
                        class="filter-btn px-4 py-2 text-red-500 border-b-2 border-red-500 font-medium">すべて</button>
                    <button id="active-tasks"
                        class="filter-btn px-4 py-2 text-gray-500 hover:text-gray-700">未完了</button>
                    <button id="completed-tasks"
                        class="filter-btn px-4 py-2 text-gray-500 hover:text-gray-700">完了</button>
                </div>

                <!-- Task List -->
                <div id="task-list" class="space-y-3">
                    <div class="text-center py-10 text-gray-400" id="empty-state">
                        <i class="fas fa-leaf text-4xl mb-3"></i>
                        <p class="text-lg">タスクがありません</p>
                        <p class="text-sm mt-1">新しいタスクを追加してください</p>
                    </div>
                </div>

                <!-- Task Stats -->
                <div class="mt-6 pt-4 border-t border-gray-200 text-sm text-gray-500 flex justify-between items-center">
                    <span id="task-count">0 タスク</span>
                    <div class="flex gap-2">
                        <button id="export-tasks" class="hover:text-blue-500" title="エクスポート">
                            <i class="fas fa-download"></i>
                        </button>
                        <button id="import-tasks" class="hover:text-green-500" title="インポート">
                            <i class="fas fa-upload"></i>
                        </button>
                        <button id="clear-completed" class="hover:text-red-500">完了をクリア</button>
                    </div>
                </div>
                <input type="file" id="import-file" accept=".json" style="display: none;">
            </div>

            <!-- Calendar Section -->
            <div class="bg-white rounded-lg shadow-md p-6 border border-gray-200 w-full lg:w-80">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-semibold text-gray-800">カレンダー</h2>
                    <div class="flex items-center space-x-2">
                        <button id="prev-month" class="text-gray-500 hover:text-red-500">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span id="current-month" class="font-medium"></span>
                        <button id="next-month" class="text-gray-500 hover:text-red-500">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-7 gap-1 mb-2">
                    <div class="text-center text-xs font-medium text-red-500">日</div>
                    <div class="text-center text-xs font-medium">月</div>
                    <div class="text-center text-xs font-medium">火</div>
                    <div class="text-center text-xs font-medium">水</div>
                    <div class="text-center text-xs font-medium">木</div>
                    <div class="text-center text-xs font-medium">金</div>
                    <div class="text-center text-xs font-medium text-blue-500">土</div>
                </div>

                <div id="calendar-days" class="grid grid-cols-7 gap-1"></div>

                <!-- Statistics -->
                <div class="mt-6 pt-4 border-t border-gray-200">
                    <h3 class="text-sm font-medium text-gray-700 mb-3">統計</h3>
                    <div class="grid grid-cols-2 gap-3 text-xs">
                        <div class="bg-blue-50 p-2 rounded text-center">
                            <div class="font-semibold text-blue-600" id="total-tasks">0</div>
                            <div class="text-gray-600">総タスク</div>
                        </div>
                        <div class="bg-green-50 p-2 rounded text-center">
                            <div class="font-semibold text-green-600" id="completed-tasks">0</div>
                            <div class="text-gray-600">完了</div>
                        </div>
                        <div class="bg-yellow-50 p-2 rounded text-center">
                            <div class="font-semibold text-yellow-600" id="pending-tasks">0</div>
                            <div class="text-gray-600">未完了</div>
                        </div>
                        <div class="bg-red-50 p-2 rounded text-center">
                            <div class="font-semibold text-red-600" id="overdue-tasks">0</div>
                            <div class="text-gray-600">期限切れ</div>
                        </div>
                    </div>
                    <div class="mt-3">
                        <div class="flex justify-between text-xs text-gray-600 mb-1">
                            <span>進捗</span>
                            <span id="progress-percentage">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="progress-bar" class="bg-red-500 h-2 rounded-full transition-all duration-300"
                                style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <!-- Upcoming Tasks -->
                <div class="mt-6 pt-4 border-t border-gray-200">
                    <h3 class="text-sm font-medium text-gray-700 mb-2">近日のタスク</h3>
                    <div id="upcoming-tasks" class="space-y-2">
                        <div class="text-center py-4 text-gray-400 text-sm">
                            近日のタスクはありません
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Side Decoration -->
    </div>

    <!-- Notification -->
    <div id="notification"
        class="fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-md shadow-lg transform translate-y-10 opacity-0 transition duration-300">
        <span id="notification-message"></span>
    </div>

    <script src="app.js"></script>
    <script>
        // Register service worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>

</html>